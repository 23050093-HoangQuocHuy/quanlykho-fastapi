{% extends "base.html" %}
{% block title %}Qu·∫£n l√Ω ƒë∆°n h√†ng{% endblock %}
{% block content %}

<div class="max-w-6xl mx-auto p-8 bg-white dark:bg-gray-800 dark:text-gray-100 shadow rounded space-y-10">

    <h2 class="text-3xl font-bold mb-6 text-center">üìù T·∫°o ƒë∆°n h√†ng</h2>

    <!-- Form t·∫°o ƒë∆°n h√†ng -->
    <form method="post" action="/orders/create" id="order-form" class="space-y-6">

        <div id="items-container" class="space-y-4">
            <div class="order-item grid grid-cols-1 md:grid-cols-4 gap-4 p-4 border dark:border-gray-600 rounded bg-gray-50 dark:bg-gray-700">

                <div>
                    <label class="block text-sm font-medium mb-1">S·∫£n ph·∫©m</label>
                    <select name="item_id" class="item-select w-full p-2 rounded border dark:bg-gray-800 dark:border-gray-600">
                        {% for item in items %}
                            <option value="{{ item.item_id }}">
                                {{ item.name }} (T·ªìn: {{ item.quantity }})
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">S·ªë l∆∞·ª£ng</label>
                    <input type="number" name="quantity" min="1" value="1"
                        class="qty-input w-full p-2 rounded border dark:bg-gray-800 dark:border-gray-600">
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">Gi√°</label>
                    <input type="number" name="price" step="0.01" required
                        class="price-input w-full p-2 rounded border dark:bg-gray-800 dark:border-gray-600">
                </div>

                <div class="flex items-end">
                    <button type="button"
                        class="remove-item-btn bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 hidden">
                        X√≥a
                    </button>
                </div>

            </div>
        </div>

        <button type="button" id="add-item-btn"
            class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
            + Th√™m s·∫£n ph·∫©m
        </button>

        <button type="submit"
            class="w-full mt-6 bg-green-600 hover:bg-green-700 text-white py-3 rounded shadow font-semibold">
            ‚úî T·∫°o ƒë∆°n h√†ng
        </button>

    </form>

    <hr class="my-10 border-gray-300 dark:border-gray-700">

    <!-- Danh s√°ch ƒë∆°n h√†ng -->
    <h2 class="text-3xl font-bold mb-4 text-center">üì¶ Danh s√°ch ƒë∆°n h√†ng</h2>

    <div class="overflow-x-auto rounded shadow">
        <table class="min-w-full text-left border border-gray-300 dark:border-gray-600">
            <thead class="bg-gray-200 dark:bg-gray-700">
                <tr>
                    <th class="px-4 py-2">M√£ ƒë∆°n</th>
                    <th class="px-4 py-2">Tr·∫°ng th√°i</th>
                    <th class="px-4 py-2">S·ªë s·∫£n ph·∫©m</th>
                </tr>
            </thead>
            <tbody>
                {% for order in orders %}
                <tr class="border-t dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700">
                    <td class="px-4 py-2">#{{ order.order_id }}</td>
                    <td class="px-4 py-2">{{ order.status }}</td>
                    <td class="px-4 py-2">{{ order.items | length }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

</div>

<script>
document.getElementById("add-item-btn").addEventListener("click", () => {
    const container = document.getElementById("items-container");
    const newItem = container.children[0].cloneNode(true);

    // hi·ªÉn th·ªã n√∫t x√≥a ·ªü item m·ªõi
    newItem.querySelector(".remove-item-btn").classList.remove("hidden");

    container.appendChild(newItem);

    newItem.querySelector(".remove-item-btn").addEventListener("click", () => {
        newItem.remove();
    });
});
</script>

{% endblock %}
